<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- fonts linked -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playpen+Sans&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

    <title>Campus Connect</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <div class="search-bar">
            <input type="text" class="search-inp" placeholder="Search...">
        </div>
        <div class="logo">
            <img src="imgs/logo.png" alt="CampusConnect" height="31px">
        </div>
        <div class="login-post-btn">
            <a href="components/login.html">
                <button class="login-btn">LOGIN</button>
            </a>
            <a href="components/postform.html">
                <button href="" class="post-btn">POST</button>
            </a>
        </div>
    </nav>
    <section class="intro">
        <div class="text">
            <p class="text-out">
                Welcome to CampusConnect
            </p>
            <br>
            <p class="text-inside">
                your go-to destination for staying in the loop with all the exciting events, announcements, and opportunities buzzing around campus.
            </p> 
        </div>
        <div class="img">
            <img src="imgs/board.png" alt="board-image" height="250px">
        </div>
    </section>

    <section class="notices" id="notice1">
        <div class="postForm">
        </div>
    </section>
   

   
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            console.log("hi")
            const postListElement = document.getElementById('notice1');
            const postForm = document.querySelector('.post-btn');
            const apiEndpoint = 'http://localhost:4200/api/post'; // Replace with your actual backend endpoint

            // Function to fetch and render posts
            function fetchAndRenderPosts() {
                fetch(apiEndpoint, {
                    method: 'GET',
                })
                .then(response => response.json())
                .then(data => {
                    // Clear the existing list
                    postListElement.innerHTML = '';

                    // Render the fetched data
                    data.forEach(post => {
                        const listItem = document.createElement('li');
    
                        // Create and append the h3 element for post content
                        const postText = document.createElement('h3');
                        postText.textContent = post.postContent;
                        listItem.appendChild(postText);

                        // Create and append the h5 element for post tags
                        const postTag = document.createElement('h5');
                        postTag.textContent = post.postTags || 'No tags'; // Use post.postTags if it exists, otherwise set it to 'No tags'
                        listItem.appendChild(postTag);

                        // Append the entire li to the postListElement
                        postListElement.appendChild(listItem);
                    });
                })
                .catch(error => console.error('Error fetching data:', error));
            }

            // Fetch and render posts on page load
            fetchAndRenderPosts();

            // Add an event listener for the form submission
            postForm.addEventListener('submit', function (event) {
                event.preventDefault(); // Prevent the default form submission

                // Fetch and render posts after submitting the form
                fetchAndRenderPosts();
            });
        });
    </script>
       
    <script src="script.js"></script>
</body>
</html>